# Transcript Generation Using GPT-3

## Set Up
1. follow instructions in the root directory README to start the sandbox.
2. install additional python3 requirements - `pip install -r requirements.txt`
3. save your Open AI API secret key (starts with `sk-`) to a file called `openai.key` in the root directory (make
sure there are no quotes or a newline at the end of the file)

## Running

Arguments:
`--query_path` - path to KB FAQs (.csv file) or squad-like QA pairs (.json file)
`--output_path` - directory to store the generated transcripts
`--kb_name` - name of Company/KB, for use in generating an appropriate Agent greeting.


### 1. From Conversation Opener
`transcript_completion` completes a transcript given the first two lines of a
conversation between Agent and Caller. It is primed with two example transcripts, see below.

Priming Prompts:

Prompt 1:
Agent: Hi, thank you for calling the Walmart Help Center, my name is Jane. How may I help you today?
Caller: Hi, yeah. I didn't get any emails for pick up?

Agent: Okay, I can help you with that. First, can I please get your name?
Caller: It's John. Do you want my email or anything?
Agent: Thanks John. If you have the order number handy, then I can check on it right now for you. An email address would also be helpful.
Caller: Okay sure, it's order number 12345678 and my email is john@gmail.com
Agent: Okay, one moment while I look that up for you.
Caller: Sure. Yeah I just want to see if it's ready to be picked up, but also it's kinda weird that I didn't get any emails about it.
Agent: Hi John, thanks for your patience. I can see here that your order isn't ready for pickup yet, but it should be in the next couple of hours. It's possible that the emails got sent to your email spam folder, so that could be worth checking. I'm sorry for the inconvenience. If you'd like, I can have the store give you a call when the order is ready instead.
Caller: Oh, that would be great.
Agent: Of course. What phone number would you like us to use?
Caller: Sure it's uh 123-456-7890
Agent: Thank you, you should be receiving a call sometime in the next few hours when your order is ready for pickup. Is there anything else I can help you with today?
Caller: No, that's it. Thanks.
Agent: My pleasure. Thank you for calling Walmart, you have a great day.

Prompt 2:
Agent: Sorry, you're speaking with Jane how may I assist you?
Caller: Hi, I'm gonna set up my email. I'm on mobile. I got a new phone and, uh, I'm following the stuff, but the. Um, I got to the E store part downloaded E store. I'm trying to log in and it's been authenticating for the past, like, 20 minutes.

Agent: ID please.
Caller: Sure, 234521.
Agent: Thanks.
Agent: Using an Android device?
Caller: Apple.
Agent: I see. And is it a private WiFi network or home network?
Caller: It's my home Wifi.
Agent: Okay could you please close all the applications and try with mobile data?
Caller: Okay, okay. So get off my WiFi.
Agent: Absolutely correct.
Caller: Okay.
Agent: Yes, please close every application on the mobile phone and make sure you restart the app store.
Caller: Okay, got it.
Agent: Okay, once you've done that, could you please try installing and setting up the email again?
Caller: Okay, just a minute.
Agent: No problem.
Caller: It's authenticating.
Caller: Oh hey, it worked! Thank you so much.
Agent: Good, I'm glad. Is there anything else you need?
Caller: No, not right now. Thanks.

How it Works:
After priming the model with the above examples, transcripts are generated by feeding the model the first two lines of
a conversation - first, a generic Agent greeting and second, an FAQ or Squad-like query from the Caller.

Example Input:
Agent: Hi, thank you for calling the Farmers Help Center, my name is Jane. How may I help you today?
Caller: Hi. What kinds of Auto insurance discounts does Farmers offer?

### 2. From FAQ
`transcript_from_faq` generates an entire transcript conversation given an FAQ (question and answer) from a KB.

Priming Prompts:

Prompt 1:
This is an FAQ for Walmart:
Question: Why did I not get an email that my items are ready for Pickup Today?
Answer: For items available for Pickup Today, we'll email/text you when it's ready For orders shipping from our warehouse, we'll send you an email as soon as the order is ready to be picked up; whether you selected to pick up from your local Fed Ex Office or to pick up from a Walmart store You can also use the Track Your Order feature in your account to follow your order's progress
Here is an example of it coming up in a support call.

Transcript
Agent: Hi, thank you for calling the Walmart Help Center, my name is Jane. How may I help you today?
Caller: Hi, yeah. I didn't get any emails for pick up?
Agent: Okay, I can help you with that. First, can I please get your name?
Caller: It's John. Do you want my email or anything?
Agent: Thanks John. If you have the order number handy, then I can check on it right now for you. An email address would also be helpful.
Caller: Okay sure, it's order number 12345678 and my email is john@gmail.com
Agent: Okay, one moment while I look that up for you.
Caller: Sure. Yeah I just want to see if it's ready to be picked up, but also it's kinda weird that I didn't get any emails about it.
Agent: Hi John, thanks for your patience. I can see here that your order isn't ready for pickup yet, but it should be in the next couple of hours. It's possible that the emails got sent to your email spam folder, so that could be worth checking. I'm sorry for the inconvenience. If you'd like, I can have the store give you a call when the order is ready instead.
Caller: Oh, that would be great.
Agent: Of course. What phone number would you like us to use?
Caller: Sure it's uh 123-456-7890
Agent: Thank you, you should be receiving a call sometime in the next few hours when your order is ready for pickup. Is there anything else I can help you with today?
Caller: No, that's it. Thanks.
Agent: My pleasure. Thank you for calling Walmart, you have a great day.


Prompt 2:
This is an FAQ for Farmers Insurance:
Question: I want to receive my billing statements online and stop receiving paper statements. I enrolled Paperless. Why am I still receiving a paper billing statement in the mail?
Answer: To receive your billing statements online, you need to enroll your billing account. The â€˜Go Paperless' program is for policy documents only. Once you login to 'your account on Farmers.com, click on 'View/Pay My Bill' to go to the billing account section. Across the top of the screen there is a menu bar. Select 'Manage My Account' in the menu bar and from the drop down list: select the Paperless Bill option. You may select to receive a paper bill or stop receiving paper bills at any time. You may also select your email options from this screen.
Here is an example of it coming up in a support call.

Transcript
Agent: Thank you for calling the Farmers Help Center. My name is Jane. How may I help you?
Caller: Hey, yeah I am still getting bills and things in the mail even though I signed up to do paperless.
Agent: You may still be receiving bills in the mail because going paperless only applies to policy documents.
Caller: Okay, so I can't get paperless bills?
Agent: No, you still can. To go paperless with your bills, please go to your account online at Farmers.com, click on Pay My Bill. In the menu bar, click on Manage my Account and select the Paperless Bill option from the dropdown. This is where you can adjust all your billing settings.
Caller: Okay, thanks.
Agent: Of course, happy to help. Do you have any other questions?
Caller: No.


Prompt 3:
This is an FAQ for Farmers Insurance:
Question: What discounts are available?
Answer: Discounts will help you save money on the premium you pay for your policy. You may qualify for a multi-policy discount if you insure more than just your bike with the same company. Specifically for motorcycles, you may be able to get discounts for taking safety courses, having an airbag or anti-lock brakes, or for being a preferred operator.
Here is an example of it coming up in a support call.

Transcript
Agent: Thank you for calling the Farmers Help Center. My name is Jane. How may I help you?
Caller: I want to know if you have any special discounts right now?
Agent: Sure, I would be happy to walk you through our discount options. What kind of insurance are you looking at?
Caller: motorcycle
Agent: Okay, great. So we do offer several forms of discount for motorcycle insurance.
Caller: Cool.
Agent: First, we have special multi-policy discounts for if you insure more than one vehicle with us. Would this apply to you?
Caller: No, I just have the one bike.
Agent: Okay, sure. We also offer discounts for taking safety courses, having an air-bag or anti-lock brakes, and for being a preferred operator.
Caller: Okay, cool. Thanks
Agent: You're welcome.

How it Works:
After priming with the above examples, transcripts are generated by feeding the model with both the question and answer
components of a KB FAQ (either from FAQ page or Squad-like dataset).

Example Input:
This is an FAQ for Farmers Insurance:
Question: What discounts are available?
Answer: Discounts will help you save money on the premium you pay for your policy. You may qualify for a multi-policy discount if you insure more than just your bike with the same company. Specifically for motorcycles, you may be able to get discounts for taking safety courses, having an airbag or anti-lock brakes, or for being a preferred operator.
Here is an example of it coming up in a support call.

